---
title: "Homework 5"
author: "Jina Moon"
date: "`r Sys.Date()`"
output:
  html_document: 
    theme: spacelab
---

## Instructions
Answer the following questions and/or complete the exercises in RMarkdown. Please embed all of your code and push the final work to your repository. Your report should be organized, clean, and run free from errors. Remember, you must remove the `#` for any included code chunks to run. Any plots must have appropriate titles and aesthetics.  

## Load the tidyverse
```{r}
library("tidyverse")
options(scipen=999) #turn off scientific notation
```

## Data
**Database of vertebrate home range sizes.** 
Reference: Tamburello N, Cote IM, Dulvy NK (2015) Energy and the scaling of animal space use. The American Naturalist 186(2):196-211. http://dx.doi.org/10.1086/682070.  
Data: http://datadryad.org/resource/doi:10.5061/dryad.q5j65/1  

**1. Load the data into a new object called `homerange`.**
```{r}
getwd()
homerange <- read.csv("data/Tamburelloetal_HomeRangeDatabase.csv")
```

**2. What is the structure of the `homerange` data? Does it have any NA's? Do a quick exploratory analysis of your choice below.**
```{r}
glimpse(homerange) #I chose to use glimpse, as it gives an overview of column names, types, as well as what kind of values each column has. From this we can see that the data does have quite a lot of NA's 
```

```{r}
summary(homerange)
#this one gives a more overview of specifics, and more detained analysis. Downside, is that it doesn't give you an idea of the raw data in the columns (NA's etc. )
```

**3. Which animal groups are represented in the data? Make a plot that shows the number in each class.**
```{r}
names(homerange)
```
```{r}
#count by class.. so bar 
ggplot(data=homerange, mapping=aes(x=class))+ 
  geom_bar(mapping=aes(fill=class))+ 
  labs(title="# of individuals per class")
```

The animal groups represented are actinopterygii, aves, mammalia, and reptilia 

**4. Are there more carnivores or herbivores represented in the data? Make a plot that shows the number in each trophic guild.**
```{r}
ggplot(data=homerange, mapping=aes(x=trophic.guild))+ 
  geom_bar(mapping=aes(fill=trophic.guild))+ 
  labs(title="# of individuals per trophic guild", x="trophic guild")
```

There are more carnivores than herbivores. 

**5. Which herbivorous mammals have homeranges greater than 1,000,000 mÂ²? Show only the common name, order, mean homerange size, and mean body mass. Arrange the data in descending order by homerange size and show only the top 10 species.**
```{r}
names(homerange)
```

```{r}
#using pipe to do this. 
homerange %>% 
  select(common.name, order, mean.hra.m2, mean.mass.g) %>% 
  filter(mean.hra.m2 > 1000000) %>% 
  arrange(desc(mean.hra.m2)) %>% 
  slice_max(mean.hra.m2, n = 10)
```

**6. Which two species have the largest and smallest homerange sizes?**
```{r}
#Species with largest homeranage size 
homerange %>% 
  select(species, mean.hra.m2) %>% 
  slice_max(mean.hra.m2, n=1)
```

The species with the largest homerange size is Tarandus (legendary reindeer-- well species). 


```{r}
#species with smallest homerange size 
homerange %>% 
  select(species, mean.hra.m2) %>% 
  slice_min(mean.hra.m2, n=1)
```

The species with the smallest homerange size is hipoliti... 

**7. Which carnivorous mammals have the largest homeranges?**
```{r}
homerange %>% 
  filter(trophic.guild == "carnivore") %>% 
  select(species, mean.hra.m2, trophic.guild) %>% 
  slice_max(mean.hra.m2, n = 10)
```

These are the top 10 carnivoes with largest homeranges. You can change the n=10 value to input less or more.

**8. Is there a relationship between body mass and homerange size? Make a scatterplot to show this relationship. Be sure to include appropriate labels and a title.**
```{r}
ggplot(data=homerange, mapping=aes(x=mean.mass.g, y=mean.hra.m2))+
  geom_point()+
  geom_smooth(method=lm, se=T)+ #added line of best fit, with standard error
  scale_x_log10()+ 
  scale_y_log10()+ 
  labs(title="Body mass (g) vs. Homerange size (m^2)", x="Body mass (g)", y="Homerange size (m^2)")
```
Yes there is a positive relationship between body mass and homerange size. 

**9. Use filter to extract the data for only birds and mammals. Then make a plot that compares the homerange sizes of these two groups. Be sure to include appropriate labels and a title.**
```{r}
extracted_homerange <- homerange %>% 
  filter(taxon == "birds" | taxon == "mammals") 

ggplot(data=extracted_homerange, mapping = aes(x=taxon, y=mean.hra.m2))+ 
  geom_boxplot(mapping=aes(color=taxon))+ 
  scale_y_log10()+ 
  labs(title="Homerange sizes between birds and mammals", x= "Taxon type", y="Home range size (m^2)")
```

The homerange sizes between birds and mammals are very simiar, with mammals having more variation than birds in general. 


**10. Do one additional exploratory analysis of your choice. Before writing the code, write the question you are trying to answer. The question should be biologically meaningful and appropriate for the data. It must include at least one `filter()`, `select()`, and `arrange()`.**

Is there a homerange difference between lake, marine, and river fishes? 

```{r}
extracted_homerange2 <- homerange %>% 
  filter(taxon == "lake fishes" | taxon == "river fishes" | taxon == "marine fishes") 

ggplot(data=extracted_homerange2, mapping = aes(x=taxon, y=mean.hra.m2))+ 
  geom_boxplot(mapping=aes(color=taxon))+ 
  scale_y_log10()+ 
  labs(title="Homerange sizes between different fish types", x= "Taxon type", y="Home range size (m^2)")
```
yes, there seems to be a visible difference in homerange sizes... with lake fishes having the most homerange, than marine, and finally river fishes having the least homerange size. 

## Knit and Upload
Please knit your work as an .html file and upload to Canvas. Homework is due before the start of the next lab. No late work is accepted. Make sure to use the formatting conventions of RMarkdown to make your report neat and clean!  