---
title: "Homework 7"
author: "Jina Moon"
date: "`r Sys.Date()`"
output:
  html_document: 
    theme: spacelab
---

## Instructions
Answer the following questions and/or complete the exercises in RMarkdown. Please embed all of your code and push the final work to your repository. Your report should be organized, clean, and run free from errors. Remember, you must remove the `#` for any included code chunks to run.  

## Load the tidyverse
```{r message=FALSE, warning=FALSE}
library("tidyverse")
library("janitor")
```

## Data 
For this assignment, we will use data from a study on elephants and the effects of poaching on tusk size.  

Reference: [Chiyo, Patrick I., Vincent Obanda, and David K. Korir. “Illegal tusk harvest and the decline of tusk size in the African elephant.” Ecology and Evolution 5, 22: 5216–5229 (2015)](https://doi.org/10.1002/ece3.1769). Data deposited at [Dryad Digital Repository](https://doi.org/10.5061/dryad.h6t7j).  

**1. Before starting data analysis, read the abstract of the paper to get an idea of the questions being asked. In 2-3 sentences, describe what the study is testing and the variables involved.**  

The study is testing the changes in elephant populations along the kenya-Tanzania border, specifically in characteristics and traits. The variables involved include the different elephant characteristics, such as tusk size, tusk circumference, and shoulder height. 

**2. Load `elephants.csv` and store it as a new object called `elephants`.**  
 
```{r}
getwd()
elephants <- read.csv("data/elephants.csv")
```

```{r}
glimpse(elephants)
```


**3. Clean the data by converting variable names to lowercase with no spaces or special characters.**  

```{r}
elephants <- elephants %>% 
  clean_names() %>%  #cleans column names 
  mutate(across(where(is.character), tolower)) #just in case
glimpse(elephants)
```

**4. Use one or more of the summary functions you have learned to get an idea of the structure of the data.**   

```{r}
glimpse(elephants) #prob a fav
summary(elephants) #also useful 
```


**5. Use `mutate()` Change the variables `years_of_sample_collection`, `elephant_id`, and `sex` to factors. Be sure to store the output as a new dataframe and use it for the remaining questions.**  

```{r}
updated_elephants <- elephants %>% 
  mutate(across(c(years_of_sample_collection, elephant_id, sex), as.factor))

glimpse(updated_elephants) #checking that everything worked as intended 
```

**6. From which years were data collected? Show the sample periods below.**  

```{r}
updated_elephants %>% 
  select(years_of_sample_collection) %>% 
  distinct()
```


**7. How many males and females were sampled in this study?**  

```{r}
updated_elephants %>% 
  count(sex)
```

416 females, and 361 males were sampled in this study. 


**8. What is the mean, median, and standard deviation for age of males and females included in the study? Separate the results by year of sample collection. Does the sampling look even between years and sexes?**  

```{r}
glimpse(updated_elephants)

#1966-68 Females 
updated_elephants %>% 
  filter(years_of_sample_collection=="1966-68", sex=="f") %>% 
  summarize(mean_1966_f = mean(estimated_age_years, na.rm=T),
            median_1966_f = median(estimated_age_years, na.rm=T), 
            sd_1966_f = sd(estimated_age_years, na.rm=T), 
            total=n())
#1966-68 Males 
updated_elephants %>% 
  filter(years_of_sample_collection=="1966-68", sex=="m") %>% 
  summarize(mean_1966_m = mean(estimated_age_years, na.rm=T),
            median_1966_m = median(estimated_age_years, na.rm=T), 
            sd_1966_m = sd(estimated_age_years, na.rm=T),
            total=n())
#2005-13 Females 
updated_elephants %>% 
  filter(years_of_sample_collection=="2005-13", sex=="f") %>% 
  summarize(mean_2005_f = mean(estimated_age_years, na.rm=T),
            median_2005_f = median(estimated_age_years, na.rm=T), 
            sd_2005_f = sd(estimated_age_years, na.rm=T),
            total=n())
#2005-13 Males 
updated_elephants %>% 
  filter(years_of_sample_collection=="2005-13", sex=="m") %>% 
  summarize(mean_2005_m = mean(estimated_age_years, na.rm=T),
            median_2005_m = median(estimated_age_years, na.rm=T), 
            sd_2005_m = sd(estimated_age_years, na.rm=T), 
            total=n())
```
No... sampling doesn't look even. There are a lot less samples for the 2005-2013 group for both female and male populations. Not as significant as the difference in years, but there also seems to be more female samples for both years than male samples. 


**9. Is age (independent variable) a positive predictor of tusk length (dependent variable)? Create a plot that shows the relationship between these variables and add a linear model fit line.**  

```{r}
#age.. continous numeric, and tusk length... also continous numeric... so scatter plot
	ggplot (data=updated_elephants, 
	mapping=aes(x=estimated_age_years, y=tusk_length_in_cm)) + 
	geom_point(na.rm=T, mapping=aes(color=sex, shape=sex)) + 
	geom_smooth(method=lm, se=T) +
	labs(title= "Age vs. Tusk Length", x= "Age (years)", y = "Tusk Length (cm)") 
```

Yes, there is a positive relationship between tusk length and age. 


**10. Is shoulder height (independent variable) a positive predictor of tusk length (dependent variable)? Create a plot that shows the relationship between these variables and add a linear model fit line.**  

```{r}
	ggplot (data=updated_elephants, 
	mapping=aes(x=shoulder_height_in_cm, y=tusk_length_in_cm)) + 
	geom_point(na.rm=T, mapping=aes(color=sex, shape=sex)) + 
	geom_smooth(method=lm, se=T) +
	labs(title= "Shoulder Height vs. Tusk Length", x= "Shoulder Height (cm)", y = "Tusk Length (cm)") 
```

Yes, shoulder height is a positive predictor for tusk length. 

**11. The authors argue that because poachers preferentially target elephants with large tusks, this has resulted in a decrease in average tusk length. Is this supported by the data? Show your code and calculations below.**  

```{r}
#need to compare old years to newer years.. categorical... and their tusk length (continuous)... so boxplot 
ggplot (data=updated_elephants, 
        mapping=aes(x=years_of_sample_collection, y=tusk_length_in_cm)) + 
        geom_boxplot(mapping=aes(fill = years_of_sample_collection)) +
        labs(title = "Years of Sample Collection vs. Tusk Length (cm)", x= "Years of Sample Collection", y = "Tusk Length (cm)") 

#can also do it with specific numbers
updated_elephants %>% 
  filter(years_of_sample_collection=="1966-68")  %>% 
    summarize(mean_1966 = mean(tusk_length_in_cm, na.rm=T))

updated_elephants %>% 
  filter(years_of_sample_collection=="2005-13")  %>% 
  summarize(mean_2005 = mean(tusk_length_in_cm, na.rm=T))


```
As seen in the boxplot, as well as the actual average tusk length calculations, there has indeed been an average decrease in tusk length. 


**12. Male elephants reach effective sexual maturity at 25 years while females are sexually mature at 12 years. Make a new dataframe that extracts only the males and females at sexual maturity. Then, make a plot that shows the range of tusk length between the two sample periods for these mature elephants.**   

```{r}
maturity_elephants <- updated_elephants %>% 
  filter((sex=="f" & estimated_age_years>=12) | (sex=="m" & estimated_age_years>=25))
maturity_elephants <- maturity_elephants #import and check 

#making the plot 
```


## Submit the Homework
1. Save your work and knit the .rmd file.  
2. Open the .html file and "print" it to a .pdf file in Google Chrome (not Safari).    
3. Go to the class Canvas page and open Gradescope.  
4. Submit your .pdf file to the homework assignment- be sure to assign the pages to the correct questions.  
5. Commit and push your work to your repository. 